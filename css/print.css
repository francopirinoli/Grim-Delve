/* ==========================================================================
   A4 PRINT STYLESHEET (Fixed Layout)
   ========================================================================== */

@media print {
    @page {
        size: A4 portrait;
        margin: 0.8cm;
    }

    /* 1. Global Page Reset */
    html, body {
        width: 100%;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        background-color: white !important;
        color: black !important;
        font-family: 'Georgia', serif;
        font-size: 10pt;
        line-height: 1.3;
        overflow: visible !important;
    }

    /* 2. THE BIG SWITCH: Hide App, Show Print */
    
    /* Hide the entire application container */
    #app-container {
        display: none !important;
    }

    /* Force the print container to be visible */
    #print-sheet-root, .print-only {
        display: block !important;
        visibility: visible !important;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
    }

    /* 3. PRINT LAYOUT COMPONENTS */

    .print-page {
        width: 100%;
        /* Force minimum height to ensure page breaks work */
        min-height: 98vh; 
        position: relative;
        break-after: page;
        page-break-after: always;
    }
    
    .print-page:last-child {
        break-after: auto;
    }

    /* Boxes & Headers */
    .p-box {
        border: 2px solid #000;
        padding: 8px;
        margin-bottom: 15px;
        background: white;
        break-inside: avoid;
    }

    .p-header {
        background: #000;
        color: #fff;
        font-weight: bold;
        text-transform: uppercase;
        text-align: center;
        padding: 4px;
        font-size: 11pt;
        border: 1px solid #000;
        margin-bottom: 10px;
    }

    /* Top Section: Portrait & ID */
    .p-top-section {
        display: flex;
        gap: 20px;
        border-bottom: 2px solid #000;
        padding-bottom: 15px;
        margin-bottom: 20px;
    }

    .p-portrait {
        width: 120px;
        height: 120px;
        border: 2px solid #000;
        background: #eee;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }
    .p-portrait img { width: 100%; height: 100%; object-fit: cover; }

    .p-identity {
        flex: 1;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px 20px;
    }

    .p-id-field { display: flex; flex-direction: column; }
    .p-id-label { font-size: 7pt; font-weight: bold; text-transform: uppercase; color: #666; }
    .p-id-val { font-size: 14pt; font-weight: bold; border-bottom: 1px solid #ccc; font-family: sans-serif; }

    /* Attributes Strip */
    .p-attributes {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        border: 2px solid #000;
        margin-bottom: 20px;
        background: #f0f0f0;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
    .p-attr-cell { border-right: 1px solid #000; text-align: center; padding: 6px; }
    .p-attr-cell:last-child { border-right: none; }
    .p-attr-name { display: block; font-weight: bold; font-size: 8pt; }
    .p-attr-val { font-size: 16pt; font-weight: bold; font-family: sans-serif; }

    /* Vitals Row */
    .p-vitals {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        margin-bottom: 20px;
    }
    .p-vital-box { border: 2px solid #000; text-align: center; padding: 5px; }
    .p-vital-box h4 { margin: 0; font-size: 8pt; text-transform: uppercase; border-bottom: 1px solid #ccc; }
    .p-vital-val { font-size: 18pt; font-weight: bold; display: block; margin-top: 5px; }

    /* Main Content Columns */
    .p-combat-grid {
        display: grid;
        grid-template-columns: 1fr 1.6fr;
        gap: 20px;
        align-items: start;
    }

    /* Defense Grid */
    .p-defense-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 5px;
        text-align: center;
        margin-bottom: 15px;
    }
    .p-ac-large {
        grid-column: 1 / -1;
        border: 3px solid #000;
        padding: 10px;
        font-size: 24pt;
        font-weight: bold;
        margin-bottom: 5px;
        display: flex; flex-direction: column; align-items: center; line-height: 1;
    }
    .p-ac-large span { font-size: 9pt; font-weight: normal; margin-top: 5px; }
    
    .p-def-box { border: 1px solid #000; padding: 4px; }
    .p-def-label { display: block; font-size: 7pt; font-weight: bold; text-transform: uppercase; }
    .p-def-val { font-size: 14pt; font-weight: bold; }

    /* Skills List */
    .p-skill-list { font-size: 9pt; }
    .p-skill-item {
        display: flex; justify-content: space-between;
        border-bottom: 1px dotted #ccc;
        margin-bottom: 3px;
    }

    /* Tables */
    .p-table { width: 100%; border-collapse: collapse; font-size: 9pt; }
    .p-table th { border-bottom: 2px solid #000; text-align: left; padding: 4px; font-size: 8pt; }
    .p-table td { border-bottom: 1px solid #ccc; padding: 5px 2px; vertical-align: top; }

    /* Notes */
    .p-notes-area {
        height: 250px;
        border: 1px solid #ccc;
        padding: 10px;
        white-space: pre-wrap;
        font-size: 10pt;
    }

    /* Page 2 Elements */
    .p-wealth {
        display: flex; justify-content: space-around;
        border: 1px solid #000; background: #eee;
        padding: 8px; margin-bottom: 15px; font-weight: bold;
    }

    .p-content-cols {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .p-feat-card {
        border: 1px solid #999;
        padding: 6px;
        margin-bottom: 5px;
        break-inside: avoid;
        background: #fdfdfd;
    }
    .p-feat-title { font-weight: bold; display: block; border-bottom: 1px dotted #000; margin-bottom: 2px; }
    .p-feat-source { float: right; font-weight: normal; font-size: 8pt; color: #555; }
    
    .p-inv-item {
        display: flex; justify-content: space-between;
        border-bottom: 1px dotted #ccc;
        padding: 3px 0;
    }
}